!function(c){var d=function(y,G,A){var b=typeof G=="object";var D;this.startDate=moment().startOf("day");this.endDate=moment().startOf("day");this.minDate=false;this.maxDate=false;this.dateLimit=false;this.showDropdowns=false;this.showWeekNumbers=false;this.timePicker=false;this.timePickerIncrement=30;this.timePicker12Hour=true;this.ranges={};this.opens="right";this.buttonClasses=["btn","btn-sm"];this.applyClass="btn-success";this.cancelClass="btn-default";this.emptyClass="btn-grey";this.format="YYYY/MM/DD";this.separator="-";this.locale={applyLabel:"\u786e\u5b9a",cancelLabel:"\u53d6\u6d88",emptyLabel:"\u6e05\u7a7a",fromLabel:"\u4ece",toLabel:"\u5230",weekLabel:"\u5468",customRangeLabel:"\u81ea\u5b9a\u4e49\u6807\u7b7e",daysOfWeek:moment()._lang._weekdaysMin.slice(),monthNames:moment()._lang._monthsShort.slice(),firstDay:0};console.log(moment());this.cb=function(){};this.element=c(y);if(this.element.hasClass("pull-right")){this.opens="left"}if(this.element.is("input")){this.element.on({click:c.proxy(this.show,this),focus:c.proxy(this.show,this)})}else{this.element.on("click",c.proxy(this.show,this))}D=this.locale;if(b){if(typeof G.locale=="object"){c.each(D,function(e,f){D[e]=G.locale[e]||f})}if(G.applyClass){this.applyClass=G.applyClass}if(G.cancelClass){this.cancelClass=G.cancelClass}if(G.emptyClass){this.emptyClass=G.emptyClass}}var F='<div class="daterangepicker dropdown-menu"><div class="calendar left"></div><div class="calendar right"></div><div class="ranges"><div class="range_inputs"><div class="daterangepicker_start_input" style="float: left"><label for="daterangepicker_start">'+this.locale.fromLabel+'</label><input class="input-mini" type="text" name="daterangepicker_start" value="" disabled="disabled" /></div><div class="daterangepicker_end_input" style="float: left; padding-left: 11px"><label for="daterangepicker_end">'+this.locale.toLabel+'</label><input class="input-mini" type="text" name="daterangepicker_end" value="" disabled="disabled" /></div><button class="'+this.applyClass+' applyBtn" disabled="disabled">'+this.locale.applyLabel+'</button><button class="'+this.cancelClass+' cancelBtn">'+this.locale.cancelLabel+"</button><button class='"+this.emptyClass+" emptyBtn'>"+this.locale.emptyLabel+"</button></div></div></div>";this.container=c(F).appendTo("body");if(b){if(typeof G.format=="string"){this.format=G.format}if(typeof G.separator=="string"){this.separator=G.separator}if(typeof G.startDate=="string"){this.startDate=moment(G.startDate,this.format)}if(typeof G.endDate=="string"){this.endDate=moment(G.endDate,this.format)}if(typeof G.minDate=="string"){this.minDate=moment(G.minDate,this.format)}if(typeof G.maxDate=="string"){this.maxDate=moment(G.maxDate,this.format)}if(typeof G.startDate=="object"){this.startDate=moment(G.startDate)}if(typeof G.endDate=="object"){this.endDate=moment(G.endDate)}if(typeof G.minDate=="object"){this.minDate=moment(G.minDate)}if(typeof G.maxDate=="object"){this.maxDate=moment(G.maxDate)}if(typeof G.ranges=="object"){for(var w in G.ranges){var E=moment(G.ranges[w][0]);var z=moment(G.ranges[w][1]);if(this.minDate&&E.isBefore(this.minDate)){E=moment(this.minDate)}if(this.maxDate&&z.isAfter(this.maxDate)){z=moment(this.maxDate)}if(this.minDate&&z.isBefore(this.minDate)||this.maxDate&&E.isAfter(this.maxDate)){continue}this.ranges[w]=[E,z]}var v="<ul>";for(var w in this.ranges){v+="<li>"+w+"</li>"}v+="<li>"+this.locale.customRangeLabel+"</li>";v+="</ul>";console.log(v);this.container.find(".ranges").prepend(v)}if(typeof G.dateLimit=="object"){this.dateLimit=G.dateLimit}if(typeof G.locale=="object"){if(typeof G.locale.firstDay=="number"){this.locale.firstDay=G.locale.firstDay;var x=G.locale.firstDay;while(x>0){this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift());x--}}}if(typeof G.opens=="string"){this.opens=G.opens}if(typeof G.showWeekNumbers=="boolean"){this.showWeekNumbers=G.showWeekNumbers}if(typeof G.buttonClasses=="string"){this.buttonClasses=[G.buttonClasses]}if(typeof G.buttonClasses=="object"){this.buttonClasses=G.buttonClasses}if(typeof G.showDropdowns=="boolean"){this.showDropdowns=G.showDropdowns}if(typeof G.timePicker=="boolean"){this.timePicker=G.timePicker}if(typeof G.timePickerIncrement=="number"){this.timePickerIncrement=G.timePickerIncrement}if(typeof G.timePicker12Hour=="boolean"){this.timePicker12Hour=G.timePicker12Hour}}if(!this.timePicker){this.startDate=this.startDate.startOf("day");this.endDate=this.endDate.startOf("day")}var t=this.container;c.each(this.buttonClasses,function(f,e){t.find("button").addClass(e)});if(this.opens=="right"){var B=this.container.find(".calendar.left");var a=this.container.find(".calendar.right");B.removeClass("left").addClass("right");a.removeClass("right").addClass("left")}if(typeof G=="undefined"||typeof G.ranges=="undefined"){this.container.find(".calendar").show();this.move()}if(typeof A=="function"){this.cb=A}this.container.addClass("opens"+this.opens);if(!b||typeof G.startDate=="undefined"&&typeof G.endDate=="undefined"){if(c(this.element).is("input[type=text]")){var C=c(this.element).val();var u=C.split(this.separator);var E,z;if(u.length==2){E=moment(u[0],this.format);z=moment(u[1],this.format)}if(E!=null&&z!=null){this.startDate=E;this.endDate=z}}}this.oldStartDate=this.startDate.clone();this.oldEndDate=this.endDate.clone();this.leftCalendar={month:moment([this.startDate.year(),this.startDate.month(),1,this.startDate.hour(),this.startDate.minute()]),calendar:[]};this.rightCalendar={month:moment([this.endDate.year(),this.endDate.month(),1,this.endDate.hour(),this.endDate.minute()]),calendar:[]};this.container.on("mousedown",c.proxy(this.mousedown,this));this.container.find(".calendar").on("click",".prev",c.proxy(this.clickPrev,this));this.container.find(".calendar").on("click",".next",c.proxy(this.clickNext,this));this.container.find(".ranges").on("click","button.applyBtn",c.proxy(this.clickApply,this));this.container.find(".ranges").on("click","button.cancelBtn",c.proxy(this.clickCancel,this));this.container.find(".ranges").on("click","button.emptyBtn",c.proxy(this.clickEmpty,this));this.container.find(".ranges").on("click",".daterangepicker_start_input",c.proxy(this.showCalendars,this));this.container.find(".ranges").on("click",".daterangepicker_end_input",c.proxy(this.showCalendars,this));this.container.find(".calendar").on("click","td.available",c.proxy(this.clickDate,this));this.container.find(".calendar").on("mouseenter","td.available",c.proxy(this.enterDate,this));this.container.find(".calendar").on("mouseleave","td.available",c.proxy(this.updateView,this));this.container.find(".ranges").on("click","li",c.proxy(this.clickRange,this));this.container.find(".ranges").on("mouseenter","li",c.proxy(this.enterRange,this));this.container.find(".ranges").on("mouseleave","li",c.proxy(this.updateView,this));this.container.find(".calendar").on("change","select.yearselect",c.proxy(this.updateMonthYear,this));this.container.find(".calendar").on("change","select.monthselect",c.proxy(this.updateMonthYear,this));this.container.find(".calendar").on("change","select.hourselect",c.proxy(this.updateTime,this));this.container.find(".calendar").on("change","select.minuteselect",c.proxy(this.updateTime,this));this.container.find(".calendar").on("change","select.ampmselect",c.proxy(this.updateTime,this));this.element.on("keyup",c.proxy(this.updateFromControl,this));this.updateView();this.updateCalendars()};d.prototype={constructor:d,mousedown:function(a){a.stopPropagation()},updateView:function(){this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year());this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year());this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.format));this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.format));if(this.startDate.isSame(this.endDate)||this.startDate.isBefore(this.endDate)){this.container.find("button.applyBtn").removeAttr("disabled")}else{this.container.find("button.applyBtn").attr("disabled","disabled")}},updateFromControl:function(){if(!this.element.is("input")){return}if(!this.element.val().length){return}var b=this.element.val().split(this.separator);var a=moment(b[0],this.format);var f=moment(b[1],this.format);if(a==null||f==null){return}if(f.isBefore(a)){return}this.startDate=a;this.endDate=f;this.notify();this.updateCalendars()},notify:function(){this.updateView();this.cb(this.startDate,this.endDate)},move:function(){var b=c(this.container).find(".ranges").outerWidth();if(c(this.container).find(".calendar").is(":visible")){var a=24;b+=c(this.container).find(".calendar").outerWidth()*2+a}if(this.opens=="left"){this.container.css({top:this.element.offset().top+this.element.outerHeight(),right:c(window).width()-this.element.offset().left-this.element.outerWidth(),left:"auto","min-width":b});if(this.container.offset().left<0){this.container.css({right:"auto",left:9})}}else{this.container.css({top:this.element.offset().top+this.element.outerHeight(),left:this.element.offset().left,right:"auto","min-width":b});if(this.container.offset().left+this.container.outerWidth()>c(window).width()){this.container.css({left:"auto",right:0})}}},show:function(a){this.container.show();this.move();if(a){a.stopPropagation();a.preventDefault()}c(document).on("mousedown",c.proxy(this.hide,this));this.element.trigger("shown",{target:a.target,picker:this})},hide:function(a){this.container.hide();if(!this.startDate.isSame(this.oldStartDate)||!this.endDate.isSame(this.oldEndDate)){this.notify()}this.oldStartDate=this.startDate.clone();this.oldEndDate=this.endDate.clone();c(document).off("mousedown",this.hide);this.element.trigger("hidden",{picker:this})},enterRange:function(a){var e=a.target.innerHTML;if(e==this.locale.customRangeLabel){this.updateView()}else{var b=this.ranges[e];this.container.find("input[name=daterangepicker_start]").val(b[0].format(this.format));this.container.find("input[name=daterangepicker_end]").val(b[1].format(this.format))}},showCalendars:function(){this.container.find(".calendar").show();this.move()},updateInputText:function(){if(this.element.is("input")){if(arguments[0]=="empty"){this.element.val("")}else{this.element.val(this.startDate.format(this.format)+this.separator+this.endDate.format(this.format))}}},clickRange:function(a){var e=a.target.innerHTML;if(e==this.locale.customRangeLabel){this.showCalendars()}else{var b=this.ranges[e];this.startDate=b[0];this.endDate=b[1];if(!this.timePicker){this.startDate.startOf("day");this.endDate.startOf("day")}this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year()).hour(this.startDate.hour()).minute(this.startDate.minute());this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year()).hour(this.endDate.hour()).minute(this.endDate.minute());this.updateCalendars();this.updateInputText();this.container.find(".calendar").hide();this.hide()}},clickPrev:function(a){var b=c(a.target).parents(".calendar");if(b.hasClass("left")){this.leftCalendar.month.subtract("month",1)}else{this.rightCalendar.month.subtract("month",1)}this.updateCalendars()},clickNext:function(a){var b=c(a.target).parents(".calendar");if(b.hasClass("left")){this.leftCalendar.month.add("month",1)}else{this.rightCalendar.month.add("month",1)}this.updateCalendars()},enterDate:function(e){var a=c(e.target).attr("data-title");var b=a.substr(1,1);var j=a.substr(3,1);var i=c(e.target).parents(".calendar");if(i.hasClass("left")){this.container.find("input[name=daterangepicker_start]").val(this.leftCalendar.calendar[b][j].format(this.format))}else{this.container.find("input[name=daterangepicker_end]").val(this.rightCalendar.calendar[b][j].format(this.format))}},clickDate:function(e){var b=c(e.target).attr("data-title");var a=b.substr(1,1);var o=b.substr(3,1);var q=c(e.target).parents(".calendar");if(q.hasClass("left")){var p=this.leftCalendar.calendar[a][o];var m=this.endDate;if(typeof this.dateLimit=="object"){var r=moment(p).add(this.dateLimit).startOf("day");if(m.isAfter(r)){m=r}}}else{var p=this.startDate;var m=this.rightCalendar.calendar[a][o];if(typeof this.dateLimit=="object"){var n=moment(m).subtract(this.dateLimit).startOf("day");if(p.isBefore(n)){p=n}}}q.find("td").removeClass("active");if(p.isSame(m)||p.isBefore(m)){c(e.target).addClass("active");this.startDate=p;this.endDate=m}else{if(p.isAfter(m)){c(e.target).addClass("active");this.startDate=p;this.endDate=moment(p).add("day",1).startOf("day")}}this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year());this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year());this.updateCalendars()},clickApply:function(a){this.updateInputText();this.hide()},clickCancel:function(a){this.startDate=this.oldStartDate;this.endDate=this.oldEndDate;this.updateView();this.updateCalendars();this.hide()},clickEmpty:function(a){this.updateInputText("empty");this.hide()},updateMonthYear:function(b){var a=c(b.target).closest(".calendar").hasClass("left");var e=this.container.find(".calendar.left");if(!a){e=this.container.find(".calendar.right")}var i=e.find(".monthselect").val();var j=e.find(".yearselect").val();if(a){this.leftCalendar.month.month(i).year(j)}else{this.rightCalendar.month.month(i).year(j)}this.updateCalendars()},updateTime:function(l){var b=c(l.target).closest(".calendar").hasClass("left");var m=this.container.find(".calendar.left");if(!b){m=this.container.find(".calendar.right")}var o=parseInt(m.find(".hourselect").val());var e=parseInt(m.find(".minuteselect").val());if(this.timePicker12Hour){var n=m.find(".ampmselect").val();if(n=="PM"&&o<12){o+=12}if(n=="AM"&&o==12){o=0}}if(b){var a=this.startDate;a.hour(o);a.minute(e);this.startDate=a;this.leftCalendar.month.hour(o).minute(e)}else{var p=this.endDate;p.hour(o);p.minute(e);this.endDate=p;this.rightCalendar.month.hour(o).minute(e)}this.updateCalendars()},updateCalendars:function(){this.leftCalendar.calendar=this.buildCalendar(this.leftCalendar.month.month(),this.leftCalendar.month.year(),this.leftCalendar.month.hour(),this.leftCalendar.month.minute(),"left");this.rightCalendar.calendar=this.buildCalendar(this.rightCalendar.month.month(),this.rightCalendar.month.year(),this.rightCalendar.month.hour(),this.rightCalendar.month.minute(),"right");this.container.find(".calendar.left").html(this.renderCalendar(this.leftCalendar.calendar,this.startDate,this.minDate,this.maxDate));this.container.find(".calendar.right").html(this.renderCalendar(this.rightCalendar.calendar,this.endDate,this.startDate,this.maxDate));this.container.find(".ranges li").removeClass("active");var f=true;var a=0;for(var b in this.ranges){if(this.timePicker){if(this.startDate.isSame(this.ranges[b][0])&&this.endDate.isSame(this.ranges[b][1])){f=false;this.container.find(".ranges li:eq("+a+")").addClass("active")}}else{if(this.startDate.format("YYYY-MM-DD")==this.ranges[b][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[b][1].format("YYYY-MM-DD")){f=false;this.container.find(".ranges li:eq("+a+")").addClass("active")}}a++}if(f){this.container.find(".ranges li:last").addClass("active")}},buildCalendar:function(t,b,z,A,i){var E=moment([b,t,1]);var v=moment(E).subtract("month",1).month();var w=moment(E).subtract("month",1).year();var a=moment([w,v]).daysInMonth();var C=E.day();var x=[];for(var y=0;y<6;y++){x[y]=[]}var u=a-C+this.locale.firstDay+1;if(u>a){u-=7}if(C==this.locale.firstDay){u=a-6}var B=moment([w,v,u,z,A]);for(var y=0,D=0,F=0;y<42;y++,D++,B=moment(B).add("day",1)){if(y>0&&D%7==0){D=0;F++}x[F][D]=B}return x},renderDropdowns:function(u,v,z){var r=u.month();var w='<select class="monthselect">';var y=false;var a=false;for(var x=0;x<12;x++){if((!y||x>=v.month())&&(!a||x<=z.month())){w+="<option value='"+x+"'"+(x===r?" selected='selected'":"")+">"+this.locale.monthNames[x]+"</option>"}}w+="</select>";var s=u.year();var t=z&&z.year()||s+5;var b=v&&v.year()||s-50;var m='<select class="yearselect">';for(var q=b;q<=t;q++){m+='<option value="'+q+'"'+(q===s?' selected="selected"':"")+">"+q+"</option>"}m+="</select>";return w+m},renderCalendar:function(u,w,x,C){var i='<div class="calendar-date">';i+='<table class="table-condensed">';i+="<thead>";i+="<tr>";if(this.showWeekNumbers){i+="<th></th>"}if(!x||x.isBefore(u[1][1])){i+='<th class="prev available"><i class="icon-arrow-left glyphicon glyphicon-arrow-left"></i></th>'}else{i+="<th></th>"}var A=this.locale.monthNames[u[1][1].month()]+u[1][1].format(" YYYY");if(this.showDropdowns){A=this.renderDropdowns(u[1][1],x,C)}i+='<th colspan="5" style="width: auto">'+A+"</th>";if(!C||C.isAfter(u[1][1])){i+='<th class="next available"><i class="icon-arrow-right glyphicon glyphicon-arrow-right"></i></th>'}else{i+="<th></th>"}i+="</tr>";i+="<tr>";if(this.showWeekNumbers){i+='<th class="week">'+this.locale.weekLabel+"</th>"}c.each(this.locale.daysOfWeek,function(f,e){i+="<th>"+e+"</th>"});i+="</tr>";i+="</thead>";i+="<tbody>";for(var a=0;a<6;a++){i+="<tr>";if(this.showWeekNumbers){i+='<td class="week">'+u[a][0].week()+"</td>"}for(var z=0;z<7;z++){var s="available ";s+=u[a][z].month()==u[1][1].month()?"":"off";if(x&&u[a][z].isBefore(x)||C&&u[a][z].isAfter(C)){s=" off disabled "}else{if(u[a][z].format("YYYY-MM-DD")==w.format("YYYY-MM-DD")){s+=" active ";if(u[a][z].format("YYYY-MM-DD")==this.startDate.format("YYYY-MM-DD")){s+=" start-date "}if(u[a][z].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")){s+=" end-date "}}else{if(u[a][z]>=this.startDate&&u[a][z]<=this.endDate){s+=" in-range ";if(u[a][z].isSame(this.startDate)){s+=" start-date "}if(u[a][z].isSame(this.endDate)){s+=" end-date "}}}}var b="r"+a+"c"+z;i+='<td class="'+s.replace(/\s+/g," ").replace(/^\s?(.*?)\s?$/,"$1")+'" data-title="'+b+'">'+u[a][z].date()+"</td>"}i+="</tr>"}i+="</tbody>";i+="</table>";i+="</div>";if(this.timePicker){i+='<div class="calendar-time">';i+='<select class="hourselect">';var B=0;var y=23;var D=w.hour();if(this.timePicker12Hour){B=1;y=12;if(D>=12){D-=12}if(D==0){D=12}}for(var v=B;v<=y;v++){if(v==D){i+='<option value="'+v+'" selected="selected">'+v+"</option>"}else{i+='<option value="'+v+'">'+v+"</option>"}}i+="</select> : ";i+='<select class="minuteselect">';for(var v=0;v<60;v+=this.timePickerIncrement){var t=v;if(t<10){t="0"+t}if(v==w.minute()){i+='<option value="'+v+'" selected="selected">'+t+"</option>"}else{i+='<option value="'+v+'">'+t+"</option>"}}i+="</select> ";if(this.timePicker12Hour){i+='<select class="ampmselect">';if(w.hour()>=12){i+='<option value="AM">AM</option><option value="PM" selected="selected">PM</option>'}else{i+='<option value="AM" selected="selected">AM</option><option value="PM">PM</option>'}i+="</select>"}i+="</div>"}return i}};c.fn.daterangepicker=function(a,b){this.each(function(){var f=c(this);if(!f.data("daterangepicker")){f.data("daterangepicker",new d(f,a,b))}});return this}}(window.jQuery);
